<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/sakura-vader.css" type="text/css">
    <link rel="shortcut icon" href="favicon.ico" type="image/x-icon">  
    <title>My Anime List</title>
    <style>
        body {
            font-size: 1.8rem;
            line-height: 1.618;
            max-width: 100vw;
            overflow-x: hidden;
            margin: auto;
            color: #a384ff;
            background-color: #260d46;
            padding: 10px;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }
        .anime-table {
            width: 100%;
            border-collapse: collapse;
        }
        .anime-table th, .anime-table td {
            border: 1px solid #ccc;
            padding: 8px;
            text-align: left;
        }
        .anime-table th {
            background-color: #120c0e;
        }
        .status-check {
            text-align: center;
        }
        .status-check input {
            pointer-events: none;
        }
        
        /* Table styling */

/* General Table Layout */
/* General Table Layout */
table {
    width: 100%;
 /* Columns take up equal space */
     table-layout: fixed;
    border-collapse: collapse;
}

td, th {
    padding: 10px;
    border: 1px solid #ddd;
    text-align: center;
    vertical-align: middle; /* Vertically center content */
    word-wrap: break-word; /* Prevent long text from overflowing */
    overflow: hidden; /* Prevent overflow of content */
    text-overflow: ellipsis;
}

@media only screen and (max-width: 480px) {
    /* horizontal scrollbar for tables if mobile screen */
    .tablemobile {
        overflow-x: auto;
        display: block;
    }
}

/* Ensure images fit properly in cells */
td img {
    max-width: 80%; /* Make sure image fits within the cell */
    height: auto; /* Maintain aspect ratio */
    display: block;
    margin: 0 auto; /* Center image in cell */
}

/* Fix body width issues */
body {
    max-width: 100vw;
    overflow-x: hidden; /* Prevent horizontal scrolling */
}

/* For smaller screens */
@media (max-width: 600px) {
    td img {
        max-width: 50px; /* Smaller image size on mobile */
    }

    td, th {
        padding: 5px; /* Adjust padding for small screens */
    }
}
        
        
        
        
        


.joe {
font-family: Helvetica Bold, sans-serif;
}
    </style>
</head>
<body>
<header>
<a href="/"><h1>Bojab Website</h1></a>
<p>Simple as frick.</p>


<div class="navbar">
  <a href="/"><h3><small>Home</small></h3></a>
  <a href="/about.html"><h3><small>About</small></h3></a>
  <a href="/social.html"><h3><small>Social</small></h3></a>
  <a href="blog.html"><h3><small>Blog</small></h3></a>
  <a href="mal.html"><h3><small>MAL</small></h3></a>
  <a href="music.html"><h3><small>Loops</small></h3></a>
  <a href="discord.html"><h3><small>Discord</small></h3></a>
  <a href="https://soundcloud.com/vinyl_lover20" target="_blank"><h3><small>Soundcloud</small></h3></a>
  <a href="https://paypal.me/LiamDaws0n?locale.x=en_US" target="_blank"><h3><small>Support</small></h3></a>
  <hr>

</div>  

</header>

<h1>Here is My Anime List :)</h1>
<p><small>It's kinda difficult to comprehend on mobile, but it's good <i>enough</i>, so whatever. It also isn't always up to date, sometimes I forget!</small></p>
<table class="anime-table">
  <thead>
    <tr>
      <th>Cover Image</th> <!-- Change column header -->
      <th>Episodes Watched</th>
      <th># Of Episodes</th>
      <th>Watching</th>
      <th>Rewatching</th>
      <th>Completed</th>
      <th>Paused</th>
      <th>Dropped</th>
      <th>Planning</th>
    </tr>
  </thead>
  <tbody id="anime-list">
    <!-- Anime rows will be dynamically inserted here -->
  </tbody>
</table>
<script>
    async function fetchAnimeList() {
        const query = `
  query ($userId: Int) {
    MediaListCollection(userId: $userId, type: ANIME) {
      lists {
        name
        entries {
          media {
            title {
              romaji
            }
            episodes
            coverImage {
              large
            }
            siteUrl
          }
          status  # Fetch the user's specific status for this anime
          progress # Fetch the number of episodes watched by the user
        }
      }
    }
  }
`;

        const variables = {
            userId: 154492 // Replace with your AniList user ID
        };

        try {
            const response = await fetch('https://graphql.anilist.co', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    query: query,
                    variables: variables
                })
            });

            const result = await response.json();
            displayAnimeList(result.data.MediaListCollection.lists);
        } catch (error) {
            console.error('Error fetching the anime list:', error);
        }
    }

    function displayAnimeList(lists) {
        const animeListElement = document.getElementById('anime-list');
        animeListElement.innerHTML = ''; // Clear previous list

        // Define the desired order of statuses
        const statusOrder = ['CURRENT', 'REWATCHING', 'PAUSED', 'COMPLETED', 'PLANNING', 'DROPPED'];

        // Flatten all entries from lists
        const allEntries = lists.flatMap(list => list.entries);

        // Sort the entries based on the status order
        const sortedEntries = allEntries.sort((a, b) => {
            return statusOrder.indexOf(a.status) - statusOrder.indexOf(b.status);
        });

        // Loop through the sorted entries and create table rows
        sortedEntries.forEach(entry => {
            const animeRow = document.createElement('tr');

            // Anime cover image cell
            const coverImageCell = `<td><a href="${entry.media.siteUrl}" target="_blank"><img src="${entry.media.coverImage.large}" alt="${entry.media.title.romaji} cover"></a></td>`;
            
            // User-specific status text
            const statusTextCell = `<td>${entry.progress || 0}</td>`;
            
            // Number of episodes
            const episodesCell = `<td>${entry.media.episodes || "N/A"}</td>`;

            // Checkmark cells for statuses
            const statusCheckCell = (status) => `
                <td class="status-check">
                    <input type="checkbox" ${entry.status === status ? 'checked' : ''}>
                </td>
            `;

            // Create row with all the data
            animeRow.innerHTML = `
                ${coverImageCell}
                ${statusTextCell}
                ${episodesCell}
                ${statusCheckCell('CURRENT')}
                ${statusCheckCell('REWATCHING')}
                ${statusCheckCell('COMPLETED')}
                ${statusCheckCell('PAUSED')}
                ${statusCheckCell('PLANNING')}
                ${statusCheckCell('DROPPED')}
            `;

            animeListElement.appendChild(animeRow);
        });
    }

    fetchAnimeList();
</script>

</body>
</html>